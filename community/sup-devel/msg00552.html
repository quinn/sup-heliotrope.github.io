<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions -->
<!--X-From-R13: Pra Inygba <ojnygbaNnegfpv.hgbebagb.pn> -->
<!--X-Date: Wed, 19 Jan 2011 10:53:57 &#45;0800 (PST) -->
<!--X-Message-Id: 1295462152&#45;sup&#45;1745@pinkfloyd.chass.utoronto.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1295375324&#45;2496&#45;1&#45;git&#45;send&#45;email&#45;sascha&#45;pgp@silbe.org -->
<!--X-Reference: 1295375324&#45;2496&#45;2&#45;git&#45;send&#45;email&#45;sascha&#45;pgp@silbe.org -->
<!--X-Reference: 1295451265&#45;sup&#45;1883@masanjin.net -->
<!--X-Reference: 1295457514&#45;sup&#45;3702@masanjin.net -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</title>
<link rev="made" href="mailto:bwalton@artsci.utoronto.ca">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00638.html">Date Prev</a>][<a href="msg00677.html">Date Next</a>][<a href="msg00566.html">Thread Prev</a>][<a href="msg00554.html">Thread Next</a>][<a href="maillist.html#00552">Date Index</a>][<a href="threads.html#00552">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</li>
<li><em>From</em>: Ben Walton &lt;<a href="mailto:bwalton%40artsci.utoronto.ca">bwalton@artsci.utoronto.ca</a>&gt;</li>
<li><em>Date</em>: Wed, 19 Jan 2011 13:41:21 -0500</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>In-reply-to</em>: &lt;<a href="msg00566.html">1295457514-sup-3702@masanjin.net</a>&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00671.html">1295375324-2496-1-git-send-email-sascha-pgp@silbe.org</a>&gt;	&lt;<a href="msg00721.html">1295375324-2496-2-git-send-email-sascha-pgp@silbe.org</a>&gt;	&lt;<a href="msg00735.html">1295451265-sup-1883@masanjin.net</a>&gt;	&lt;<a href="msg00566.html">1295457514-sup-3702@masanjin.net</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: Sup/git</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Excerpts from William Morgan's message of Wed Jan 19 12:19:11 -0500 2011:

&gt; Actually, I think it should be:
&gt; 
&gt;   if File.exists?(fn) &amp;&amp; File.size(fn) &gt; 0

How about:

begin
   fninf = File.stat(fn)
   if fninf.size? ...

rescue Errno::ENOENT =&gt; e
...
end
       
I didn't look at the surrounding code so I'm not sure how to best
integrate this.  The advantage is that you save one user-&gt;kernel space
traversal.  Calling .exists? and .size via File results in two stat()
calls.  Grabbing and saving the actual stat result on the first call
and then using them for further tests saves this.  Not a huge
overhead, I admit...

HTH.
-Ben
--
Ben Walton
Systems Programmer - CHASS
University of Toronto
C:416.407.5610 | W:416.978.4302

_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00671" href="msg00671.html">[sup-devel] [PATCH 1/2] ensure sources.yaml gets flushed to disk</a></strong>
<ul><li><em>From:</em> Sascha Silbe &lt;sascha-pgp@silbe.org&gt;</li></ul></li>
<li><strong><a name="00721" href="msg00721.html">[sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</a></strong>
<ul><li><em>From:</em> Sascha Silbe &lt;sascha-pgp@silbe.org&gt;</li></ul></li>
<li><strong><a name="00735" href="msg00735.html">Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
<li><strong><a name="00566" href="msg00566.html">Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00638.html">Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00677.html">Re: [sup-devel] Strange maildir/OfflineImap/maildir-sync behavior</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00566.html">Re: [sup-devel] [PATCH 2/2] {config,	sources}.yaml: preserve symlinks and permissions</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00554.html">[sup-devel] console gem 0.3</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00552"><strong>Date</strong></a></li>
<li><a href="threads.html#00552"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

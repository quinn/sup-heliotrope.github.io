--- lib/sup/message.rb.orig	2010-08-04 12:05:44.000000000 +0100
+++ lib/sup/message.rb	2010-08-04 13:27:07.000000000 +0100
@@ -25,7 +25,26 @@
   end
 
   QUOTE_PATTERN = /^\s{0,4}[>|\}]/
-  BLOCK_QUOTE_PATTERN = /^-----\s*Original Message\s*----+$/
+
+  BLOCK_QUOTE_PATTERNS =
+    [
+      # NB: these should preferably not be anchored to line endings ('$') due
+      # to line ending encodings ('=20').
+
+      # At least three dashes.  Mozilla mail clients downcase the 'm' in
+      # message.
+      /^----+\s*Original (M|m)essage\s*----+/,
+
+      # Microsoft Entourage doesn't indent quoted text, but it can be spotted
+      # with this line:
+      #   On 8/2/10 1:23 PM, "John Doe" <edward@facebook.com> wrote:
+      /^On \d+\/\d+\/\d+ .+ wrote:/,
+    ]
+
+  if ar = $config[:block_quote_patterns]
+    BLOCK_QUOTE_PATTERNS += ar.map{ |s| Regexp.new(s) }
+  end
+
   SIG_PATTERN = /(^-- ?$)|(^\s*----------+\s*$)|(^\s*_________+\s*$)|(^\s*--~--~-)|(^\s*--\+\+\*\*==)/
 
   MAX_SIG_DISTANCE = 15 # lines from the end
@@ -540,8 +559,13 @@
           newstate = :quote
         elsif line =~ SIG_PATTERN && (lines.length - i) < MAX_SIG_DISTANCE
           newstate = :sig
-        elsif line =~ BLOCK_QUOTE_PATTERN
-          newstate = :block_quote
+        else
+          for pattern in BLOCK_QUOTE_PATTERNS
+            if line =~ pattern
+              newstate = :block_quote
+              break
+            end
+          end
         end
 
         if newstate

<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] sup dies when gpgme not present -->
<!--X-From-R13: Vnzvfu R <qzvfuqNtznvy.pbz> -->
<!--X-Date: Thu, 27 Jan 2011 04:29:22 &#45;0800 (PST) -->
<!--X-Message-Id: AANLkTi=52GtjhbzqvtMESP4Yn=npir_6x63pNp6sX=SL@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] sup dies when gpgme not present</title>
<link rev="made" href="mailto:dmishd@gmail.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00676.html">Date Prev</a>][<a href="msg00462.html">Date Next</a>][<a href="msg00392.html">Thread Prev</a>][<a href="msg00462.html">Thread Next</a>][<a href="maillist.html#00590">Date Index</a>][<a href="threads.html#00590">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] sup dies when gpgme not present</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-devel] sup dies when gpgme not present</li>
<li><em>From</em>: Hamish D &lt;<a href="mailto:dmishd%40gmail.com">dmishd@gmail.com</a>&gt;</li>
<li><em>Date</em>: Thu, 27 Jan 2011 12:02:51 +0000</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a>; dkim=neutral (body hash did not verify) header.i=@gmail.com</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:date:message-id:subject:from:to	:content-type; bh=G5aG5fBNktMxPbGr8/mHvBZO6Ergb4o7x/Ra1O+zeAg=;	b=k2HeYDKlJGNp2/yd3xVqKZ0vm0FkZsNI8NqOk4K2OHon895+p+y/xtEX+LLl4GCDSZ	/ZvO4mLtOmeC5HiAyA9FrTSlCHK5sObVt8mYYZbsiqrtMV896AJ7+38oE12X/2QS0xBt	mPRGq8Z6ivCMvC50fzGUhXyEPXbV/OMzruVZk=</li>
<li><em>Domainkey-signature</em>: a=rsa-sha1; c=nofws; d=gmail.com; s=gamma;	h=mime-version:date:message-id:subject:from:to:content-type;	b=XRSSfc0+UgWTLWWPjwq5QeJCgKyf6psvDsbIawdKhiDWFunPx6LFAfkT59L6In4m1H	9cGj8J8mVvI+vv2EmTgew8u/8RzUNoX4NSxu4chvnFHdLd2n9qEr5sYgkk9A6vt2IDOZ	zMUu4bmRFhtNdKVK2LXNeF1qEE3HqX0zPZYvA=</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&gt;&gt; I have some more ideas for improvements, but I'm happy that this
&gt;&gt; reproduces the behaviour of using the gpg binary, and I find sup usage
&gt;&gt; much smoother with this change.

Thank you.

&gt; When the gpgme gem is not installed, this patch makes sup die on start
&gt; with:
&gt;
&gt; --- NameError from thread: main
&gt; uninitialized constant Redwood::CryptoManager::GPGME
&gt; /home/alvherre/Code/sup-mail/lib/sup/crypto.rb:49:in `initialize'
&gt; ...

The code around that line is:

    # test if the gpgme gem is available
    @gpgme_present =
      begin
        begin
          GPGME.check_version({:protocol =&gt; GPGME::PROTOCOL_OpenPGP})
     &lt;-- line 49
          true
        rescue GPGME::Error
          false
        end
      rescue NameError
        false
      end

So we should rescue the NameError. Could you check whether the code
for your sup looks like that? Could you also temporarily remove the
gpgme gem, update to the latest from master and see if you still get
the same problem?

Thanks in advance, and sorry for not getting back sooner.
Hamish
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00462" href="msg00462.html">Re: [sup-devel] sup dies when gpgme not present</a></strong>
<ul><li><em>From:</em> Alvaro Herrera &lt;alvherre@alvh.no-ip.org&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00676.html">Re: [sup-devel] call for new maintainers</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00462.html">Re: [sup-devel] sup dies when gpgme not present</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00392.html">Re: [sup-devel] Patch: Always try to canonize person name using	ContactManager</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00462.html">Re: [sup-devel] sup dies when gpgme not present</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00590"><strong>Date</strong></a></li>
<li><a href="threads.html#00590"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

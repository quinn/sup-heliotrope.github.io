<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] editing messages outside of sup -->
<!--X-From-R13: Wpb Rbbearxnzc <fhcNmrii.ay> -->
<!--X-Date: Sun, 27 Feb 2011 12:20:02 &#45;0800 (PST) -->
<!--X-Message-Id: 1298833983&#45;sup&#45;4830@pruts.nl -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1298239068&#45;sup&#45;6985@whisper -->
<!--X-Reference: 1298747943&#45;sup&#45;9749@whisper -->
<!--X-Reference: 1298768518&#45;sup&#45;4041@alvh.no&#45;ip.org -->
<!--X-Reference: 1298774629&#45;sup&#45;4062@medusa -->
<!--X-Reference: 1298819507&#45;sup&#45;8138@pruts.nl -->
<!--X-Reference: 1298826314&#45;sup&#45;276@whisper -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] editing messages outside of sup</title>
<link rev="made" href="mailto:sup@zevv.nl">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00540.html">Date Prev</a>][<a href="msg00518.html">Date Next</a>][<a href="msg00540.html">Thread Prev</a>][<a href="msg00487.html">Thread Next</a>][<a href="maillist.html#00495">Date Index</a>][<a href="threads.html#00495">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] editing messages outside of sup</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-devel] editing messages outside of sup</li>
<li><em>From</em>: Ico Doornekamp &lt;<a href="mailto:sup%40zevv.nl">sup@zevv.nl</a>&gt;</li>
<li><em>Date</em>: Sun, 27 Feb 2011 20:44:15 +0100</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>In-reply-to</em>: &lt;1298826314-sup-276@whisper&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;1298239068-sup-6985@whisper&gt; &lt;1298747943-sup-9749@whisper&gt;	&lt;<a href="msg00538.html">1298768518-sup-4041@alvh.no-ip.org</a>&gt;	&lt;1298774629-sup-4062@medusa&gt; &lt;<a href="msg00585.html">1298819507-sup-8138@pruts.nl</a>&gt;	&lt;1298826314-sup-276@whisper&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: Sup/git</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>* On Sun Feb 27 18:20:55 +0100 2011, Hamish wrote:
 
&gt; Excerpts from Ico Doornekamp's message of Sun Feb 27 15:31:14 +0000 2011:
&gt; &gt; &gt; Hamish, definitely thank you for doing something about this.  I
&gt; &gt; &gt; actually had a general question about this problem a while back - if
&gt; &gt; &gt; it is possible to edit the message independently via the approach you
&gt; &gt; &gt; took in this patch, why can't the editor be fired up in a
&gt; &gt; &gt; &quot;nonblocking&quot; kind of mode in the first place?  Something like a
&gt; &gt; &gt; fork()/exec() to start the editor, and then handling SIGCHLD rather
&gt; &gt; &gt; than calling a variant of wait() immediately.  The SIGCHLD handling
&gt; &gt; &gt; could check the return code from the editor, and then update the
&gt; &gt; &gt; message sending buffer appropriately.
&gt; &gt; 
&gt; &gt; But in what tty should the forked editor run then? I guess the above
&gt; &gt; idea would work for spawning an editor under X, but can not be used when
&gt; &gt; running on a (remote) console. I guess the 'vim --remote' solution would
&gt; &gt; be feasable, bug I guess this is not simple enough to add as an
&gt; &gt; out-of-the-box solution.
&gt; 
&gt; If you have ssh'ed to a remote machine then I don't think there is a
&gt; good way to manage this automatically without turning sup into screen
&gt; (which I think would be a bad idea), though I wouldn't want to get in
&gt; the way of imaginative hooks of course.

I've just hooked up a few lines of code (standalone, not part of sup)
that forks two editors (one joe, one vim) in ptys and handling both
terminal outputs with select(), allowing me to 'switch' between
processes on-the-fly using a magic keystroke. Redrawing is forced before
'switching' to a process by doing a TIOCSWINSZ ioctl and sending a
SIGWINCH twice, first with a fake, then with the true window size. This
is not quite a complete rewrite of screen, but seems to work quite well.
(Although I'm sure there are plenty of cases not covered by this crude
method of switching)

When the infrastructure for background-editor hooks is there, I'm ready
to try to make the hook!

-- 
:wq
^X^Cy^K^X^C^C^C^C
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00487" href="msg00487.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Hamish &lt;dmishd@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00577" href="msg00577.html">[sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Hamish &lt;dmishd@gmail.com&gt;</li></ul></li>
<li><strong><a name="00549" href="msg00549.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Hamish &lt;dmishd@gmail.com&gt;</li></ul></li>
<li><strong><a name="00538" href="msg00538.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Alvaro Herrera &lt;alvherre@alvh.no-ip.org&gt;</li></ul></li>
<li><strong><a name="00433" href="msg00433.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Roni Choudhury &lt;roni@cs.utah.edu&gt;</li></ul></li>
<li><strong><a name="00585" href="msg00585.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Ico Doornekamp &lt;sup@zevv.nl&gt;</li></ul></li>
<li><strong><a name="00540" href="msg00540.html">Re: [sup-devel] editing messages outside of sup</a></strong>
<ul><li><em>From:</em> Hamish &lt;dmishd@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00540.html">Re: [sup-devel] editing messages outside of sup</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00518.html">Re: [sup-devel] sup-server revisited</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00540.html">Re: [sup-devel] editing messages outside of sup</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00487.html">Re: [sup-devel] editing messages outside of sup</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00495"><strong>Date</strong></a></li>
<li><a href="threads.html#00495"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

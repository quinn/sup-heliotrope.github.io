From e802cdf5c960bbffb1ba2ae0f70a21f364657c5d Mon Sep 17 00:00:00 2001
From: Gaudenz Steinlin <gaudenz@soziologie.ch>
Date: Thu, 17 Feb 2011 15:33:11 +0100
Subject: [PATCH 1/2] Don't normalize_whitespace message/rfc822 parts

Currently whitespace normalization is done on the whole message
including headers and before setting the correct encoding. This causes
exceptions on ruby 1.9 for non ASCII messages.

These part's are recursively parsed as normal messages later on.
Whitespace normalization is then done on the body. This should be
enough.
---
 lib/sup/message.rb |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

diff --git a/lib/sup/message.rb b/lib/sup/message.rb
index 66745ca..a6216b5 100644
--- a/lib/sup/message.rb
+++ b/lib/sup/message.rb
@@ -443,7 +443,6 @@ private
         else
           raise RMail::EncodingUnsupportedError, encoding.inspect
         end
-        body = body.normalize_whitespace
         payload = RMail::Parser.read(body)
         from = payload.header.from.first ? payload.header.from.first.format : ""
         to = payload.header.to.map { |p| p.format }.join(", ")
-- 
1.7.2.3


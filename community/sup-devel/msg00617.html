<!-- MHonArc v2.6.18 -->
<!--X-Subject: [sup&#45;devel] [PATCH] 'u' in thread&#45;view&#45;mode copies URL to X	selection -->
<!--X-From-R13: Quevf Bnefbaf <pwcnefbaf1Nlnubb.pb.hx> -->
<!--X-Date: Thu, 4 Nov 2010 10:11:06 &#45;0700 (PDT) -->
<!--X-Message-Id: 1288885683&#45;sup&#45;601@chris&#45;eee -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</title>
<link rev="made" href="mailto:cjparsons1@yahoo.co.uk">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00424.html">Date Prev</a>][<a href="msg00584.html">Date Next</a>][<a href="msg00758.html">Thread Prev</a>][<a href="msg00584.html">Thread Next</a>][<a href="maillist.html#00617">Date Index</a>][<a href="threads.html#00617">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: [sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</li>
<li><em>From</em>: Chris Parsons &lt;<a href="mailto:cjparsons1%40yahoo.co.uk">cjparsons1@yahoo.co.uk</a>&gt;</li>
<li><em>Date</em>: Thu, 04 Nov 2010 15:49:03 +0000</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a>; dkim=neutral (body hash did not verify) header.i=@yahoo.co.uk</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024;	t=1288885757; bh=JK3snf/aSiUW8qDCyMFiFHDtmmZW8h+2P5gGhHAkUdw=;	h=X-Yahoo-Newman-Id:Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Received:Content-Type:From:To:Subject:Date:Message-Id:User-Agent:Content-Transfer-Encoding;	b=d2nMz73zTc3mYLuSOsaDx9/cucsW3buOVAfuXK/zJhCk3J2dgQlupXwTxmYCqD8bZig+432MrIb1DerpH9RY3RFMUqLdlh0D0zvTeipG/Rb2QAJwsmwPq9WVLDamjKm7r6m0mqe7ysFeLP2rXPtECPW+vWq8wUkhzMAVDgO+/H0=</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: Sup/git</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>I know there's been some discussion about opening URLs from e-mails in Sup, and
because many people use Sup via an SSH session, client-side solutions are not
universally useful... but here is a patch that seems to copy a URL on the
currently highlighted line to the X selection buffer. (From there I use Kupfer
<a  rel="nofollow" href="http://kaizer.se/wiki/kupfer/">http://kaizer.se/wiki/kupfer/</a> to open the link in a web client.)
Obviously you can do something similar with a mouse but I use a
netbook and try to avoid using the trackpad if I can.

It relies on having the program xsel available in your path.

I've never fiddled in Ruby before so accept my apologies if the lines are
ridiculous, and also if this has been done before by others.

For the reasons I mention (not universal, requires xsel) I don't
expect it to make it into the Sup code base but I put it out here in
case it suits anyone else.
---
 lib/sup/modes/line-cursor-mode.rb |   13 +++++++++++++
 1 files changed, 13 insertions(+), 0 deletions(-)

diff --git a/lib/sup/modes/line-cursor-mode.rb b/lib/sup/modes/line-cursor-mode.rb
index 1cae994..e65cbee 100644
--- a/lib/sup/modes/line-cursor-mode.rb
+++ b/lib/sup/modes/line-cursor-mode.rb
@@ -8,6 +8,7 @@ class LineCursorMode &lt; ScrollMode
     k.add :cursor_down, &quot;Move cursor down one line&quot;, :down, 'j'
     k.add :cursor_up, &quot;Move cursor up one line&quot;, :up, 'k'
     k.add :select, &quot;Select this item&quot;, :enter
+    k.add :selurl, &quot;Copy URL to selection&quot;, 'u'
   end
 
   attr_reader :curpos
@@ -90,6 +91,18 @@ protected
     set_cursor_pos botline - 1 if @curpos &gt; botline - 1
   end
 
+  def selurl
+     regex = /(?:http|https|mailto):\/\/\S+/i
+     this_line = self[curpos][0][1]
+     match = regex.match(this_line)
+     return if not match
+
+     output = pipe_to_process(&quot;xsel -i&quot;) do |stream|
+        stream.print match
+     end
+     BufferManager.flash &quot;selected url #{match}&quot;
+  end
+
   def cursor_down
     call_load_more_callbacks buffer.content_height if @curpos &gt;= lines - [buffer.content_height/2,1].max
     return false unless @curpos &lt; lines - 1
-- 
1.7.3.2
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00584" href="msg00584.html">Re: [sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</a></strong>
<ul><li><em>From:</em> Alvaro Herrera &lt;alvherre@alvh.no-ip.org&gt;</li></ul></li>
<li><strong><a name="00620" href="msg00620.html">Re: [sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</a></strong>
<ul><li><em>From:</em> Michael Stapelberg &lt;michael+sup@stapelberg.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00424.html">Re: [sup-devel] Message#text_to_chunks performance</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00584.html">Re: [sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00758.html">Re: [sup-devel] [PATCH] More UTF-8 support; load all labels as UTF-8</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00584.html">Re: [sup-devel] [PATCH] 'u' in thread-view-mode copies URL to X	selection</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00617"><strong>Date</strong></a></li>
<li><a href="threads.html#00617"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

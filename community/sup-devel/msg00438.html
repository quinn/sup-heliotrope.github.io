<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] [sup&#45;talk] turnsole alpha preview -->
<!--X-From-R13: [ngguvrh Dnxbgbwnban <zngguvrh.enxbgbwnbanNtznvy.pbz> -->
<!--X-Date: Sat, 2 Apr 2011 20:58:57 &#45;0700 (PDT) -->
<!--X-Message-Id: AANLkTimv9yUTMQ+Xc8bshBFU&#45;eogs&#45;K&#45;6QVWLY+_J3aY@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1301767622&#45;sup&#45;4907@masanjin.net -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] [sup-talk] turnsole alpha preview</title>
<link rev="made" href="mailto:matthieu.rakotojaona@gmail.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00428.html">Date Prev</a>][<a href="msg00710.html">Date Next</a>][<a href="msg00428.html">Thread Prev</a>][<a href="msg00710.html">Thread Next</a>][<a href="maillist.html#00438">Date Index</a>][<a href="threads.html#00438">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] [sup-talk] turnsole alpha preview</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Subject</em>: Re: [sup-devel] [sup-talk] turnsole alpha preview</li>
<li><em>From</em>: Matthieu Rakotojaona &lt;<a href="mailto:matthieu.rakotojaona%40gmail.com">matthieu.rakotojaona@gmail.com</a>&gt;</li>
<li><em>Date</em>: Sun, 3 Apr 2011 00:39:41 +0200</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a>; dkim=neutral (body hash did not verify) header.i=@gmail.com</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:in-reply-to:references:date	:message-id:subject:from:to:content-type:content-transfer-encoding;	bh=QN8InsUXJO23uqJaVe4Za209lSYyc0aKMEdYI5NlAnc=;	b=uTxhCkt9Ggr91aV74WvPDjCaGDScYPq3lId/V0DlRdZR/YVyxo2CRZ20GYR7pHnNau	dR3v68delXuyvJr3EQKlE8JsmNcZqix2H1lqCYJLSSKJXfZ7drvM3y/4KktNNZ8dh7Bi	anOC/YKduzeQyp1tQj20sRlmcA5BX7w+Xo+Uo=</li>
<li><em>Domainkey-signature</em>: a=rsa-sha1; c=nofws; d=gmail.com; s=gamma;	h=mime-version:in-reply-to:references:date:message-id:subject:from:to	:content-type:content-transfer-encoding;	b=YUb/EAx/zFMZO7EoOI5mTdAJUZkf2xSri5STRVvO+MkivzHBGYDIvunEq8PvLwiZCG	8uM1uXboP2txPo5tUHK6083585CK0hMlrFnbDkGBwAEEOVlc7YZ+XhDKdk4l30b06wq1	SLM4282IMB9I2iQgi4mMFLRs2MUMqvXfxG4fY=</li>
<li><em>In-reply-to</em>: &lt;<a href="msg00422.html">1301767622-sup-4907@masanjin.net</a>&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00422.html">1301767622-sup-4907@masanjin.net</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello there,

I'd like to give you some backtraces of the problems that occur when I
use heliotrope/turnsole. I have absolutely no knowledge in ruby, so I
hope this will help everyone who is developing

I'd like to point out a few problems about turnsole :
- you need to install the 'locale' gem
- I happen to have a 256colors terminal (rxvt-unicode-256color), and
the &quot;color!&quot; method in ncurses-patch.rb seems to fail :

&gt;rakoo@Otokar % ruby -Ilib -I ../heliotrope/lib bin/turnsole
&gt;/home/rakoo/src/turnsole/lib/turnsole/ncurses-patches.rb:19:in `block in &lt;module:Curses&gt;': undefined method `color!' for Curses:Module (NoMethodError)
&gt;	from /home/rakoo/src/turnsole/lib/turnsole/ncurses-patches.rb:19:in `times'
&gt;	from /home/rakoo/src/turnsole/lib/turnsole/ncurses-patches.rb:19:in `&lt;module:Curses&gt;'
&gt;	from /home/rakoo/src/turnsole/lib/turnsole/ncurses-patches.rb:1:in `&lt;top (required)&gt;'
&gt;	from &lt;internal:lib/rubygems/custom_require&gt;:29:in `require'
&gt;	from &lt;internal:lib/rubygems/custom_require&gt;:29:in `require'
&gt;	from /home/rakoo/src/turnsole/lib/turnsole.rb:16:in `&lt;top (required)&gt;'
&gt;	from &lt;internal:lib/rubygems/custom_require&gt;:29:in `require'
&gt;	from &lt;internal:lib/rubygems/custom_require&gt;:29:in `require'
&gt;	from bin/turnsole:5:in `&lt;main&gt;'

- When I switch back to xterm with 8 colors, the previous error
doesn't occur (the if test fais), but I have a problem with &quot;gpgkey&quot; :

rakoo@Otokar % ruby -I lib -I ../heliotrope/lib bin/turnsole
&gt;/home/rakoo/src/turnsole/lib/turnsole/accounts.rb:39:in `block in add_account': undefined method `gpgkey' for nil:NilClass (NoMethodError)
&gt;        from /home/rakoo/src/turnsole/lib/turnsole/accounts.rb:39:in `each'
&gt;        from /home/rakoo/src/turnsole/lib/turnsole/accounts.rb:39:in `add_account'
&gt;        from /home/rakoo/src/turnsole/lib/turnsole/accounts.rb:25:in `initialize'
&gt;        from /home/rakoo/src/turnsole/lib/turnsole.rb:96:in `new'
&gt;        from /home/rakoo/src/turnsole/lib/turnsole.rb:96:in `setup!'
&gt;        from bin/turnsole:75:in `&lt;main&gt;'

These happened with ruby v1.8 and 1.9.2, and gems v1.3.7.

Now with heliotrope, I have the problems with the encoding :
- When I search for words with &quot;&#xE9;&quot;, I have an error :

&gt;HeliotropeServer::RequestError - can't parse query: parse error: line 1: syntax error, unexpected $end, expecting WORD:
&gt; bin/heliotrope-server:137:in `rescue in block in &lt;class:HeliotropeServer&gt;'
&gt; bin/heliotrope-server:114:in `block in &lt;class:HeliotropeServer&gt;'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:1126:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:1126:in `block in compile!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:709:in `instance_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:709:in `route_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:693:in `block (2 levels) in route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:741:in `block in process_route'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:738:in `catch'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:738:in `process_route'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:692:in `block in route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:691:in `each'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:691:in `route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:826:in `dispatch!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:619:in `block in call!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `instance_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `block in invoke'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `catch'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `invoke'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:619:in `call!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:604:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/showexceptions.rb:21:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/lint.rb:48:in `_call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/lint.rb:36:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/showexceptions.rb:24:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/commonlogger.rb:18:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/content_length.rb:13:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/handler/webrick.rb:52:in `service'
&gt; /usr/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
&gt; /usr/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
&gt; /usr/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'
&gt;127.0.0.1 - - [03/Apr/2011 00:24:50] &quot;GET /search?q=%22%C3%A9%22 HTTP/1.1&quot; 500 82586 0.0504
&gt;Otokar - - [03/Apr/2011:00:24:50 CEST] &quot;GET /search?q=%22%C3%A9%22 HTTP/1.1&quot; 500 82586
&gt;<a  rel="nofollow" href="http://localhost:8042/search?q=%22zegzaegsg%22">http://localhost:8042/search?q=%22zegzaegsg%22</a> -&gt; /search?q=%22%C3%A9%22

- an error also happens when I want to see some messages, that doesn't
happen when I use ruby v1.8 instead :

&gt;ArgumentError - invalid byte sequence in UTF-8:
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:217:in `split'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:217:in `parse_header'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:194:in `parse_low'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:183:in `parse'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:331:in `parse'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rmail-1.0.0/lib/rmail/parser.rb:345:in `read'
&gt; /home/rakoo/src/heliotrope/lib/heliotrope/message.rb:17:in `parse!'
&gt; bin/heliotrope-server:292:in `load_actual_message'
&gt; bin/heliotrope-server:297:in `message_to_html'
&gt; bin/heliotrope-server:209:in `block in &lt;class:HeliotropeServer&gt;'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:1125:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:1125:in `block in compile!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:709:in `instance_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:709:in `route_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:693:in `block (2 levels) in route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:741:in `block in process_route'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:738:in `catch'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:738:in `process_route'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:692:in `block in route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:691:in `each'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:691:in `route!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:826:in `dispatch!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:619:in `block in call!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `instance_eval'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `block in invoke'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `catch'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:791:in `invoke'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:619:in `call!'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/base.rb:604:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/sinatra-1.2.1/lib/sinatra/showexceptions.rb:21:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/lint.rb:48:in `_call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/lint.rb:36:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/showexceptions.rb:24:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/commonlogger.rb:18:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/content_length.rb:13:in `call'
&gt; /usr/lib/ruby/gems/1.9.1/gems/rack-1.2.2/lib/rack/handler/webrick.rb:52:in `service'
&gt; /usr/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
&gt; /usr/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
&gt; /usr/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

These problems seem to happen because of my mails being encoded in
UTF-8. When the charset is &quot;ISO-8859-1&quot; or &quot;US-ASCII&quot;, they appear
fine. But I do think everyone should use UTF-8.

In a totallly unrelated note, do you plan on syncing back heliotrope
work with the maildir directory ? Just to know.

Thank you for your sweet coding,

-- 
Matthieu RAKOTOJAONA
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00710" href="msg00710.html">Re: [sup-devel] [sup-talk] turnsole alpha preview</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00422" href="msg00422.html">[sup-devel] turnsole alpha preview</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00428.html">Re: [sup-talk] turnsole alpha preview</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00710.html">Re: [sup-devel] [sup-talk] turnsole alpha preview</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00428.html">Re: [sup-talk] turnsole alpha preview</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00710.html">Re: [sup-devel] [sup-talk] turnsole alpha preview</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00438"><strong>Date</strong></a></li>
<li><a href="threads.html#00438"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

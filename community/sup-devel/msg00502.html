<!-- MHonArc v2.6.18 -->
<!--X-Subject: [sup&#45;devel] Query for largest msg_id? -->
<!--X-From-R13: Vbenpvb Enafba <ufnafbaNtznvy.pbz> -->
<!--X-Date: Tue, 10 May 2011 09:20:02 &#45;0700 (PDT) -->
<!--X-Message-Id: BANLkTi=bSNyp+8XFCRpYGojuM8Ub5PjB2A@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[sup-devel] Query for largest msg_id?</title>
<link rev="made" href="mailto:hsanson@gmail.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00619.html">Date Prev</a>][<a href="msg00650.html">Date Next</a>][<a href="msg00619.html">Thread Prev</a>][<a href="msg00313.html">Thread Next</a>][<a href="maillist.html#00502">Date Index</a>][<a href="threads.html#00502">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sup-devel] Query for largest msg_id?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: [sup-devel] Query for largest msg_id?</li>
<li><em>From</em>: Horacio Sanson &lt;<a href="mailto:hsanson%40gmail.com">hsanson@gmail.com</a>&gt;</li>
<li><em>Date</em>: Wed, 11 May 2011 00:17:47 +0900</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a>; dkim=neutral (body hash did not verify) header.i=@gmail.com</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma;	h=domainkey-signature:mime-version:date:message-id:subject:from:to	:content-type; bh=9Ut/LTxchXIcDuWC3phu/ZemFs/d44ocP3UgvEGxGEg=;	b=CqVL+mux1lIIldfDkqSfjgJs1gdc0MULa3SW4NTmCW30J75T9FxNjUeJi38Vf7EBQv	Zm6Kgun5Ih8lodRwmRmmi76BkSNx+GLuTYmQXHJwrXLsiwbkBo4M1PRRICRpLxQept59	xHJ6iHawmsgzYJGv3/9TkUQssNeG0KOxy1mT0=</li>
<li><em>Domainkey-signature</em>: a=rsa-sha1; c=nofws; d=gmail.com; s=gamma;	h=mime-version:date:message-id:subject:from:to:content-type;	b=N+bqb4spI2ASL1oGXTW40adLZF82LOGazrCwq36U/XDKgLuY9e0kz3gMZ1WadK3nXk	s04favrbzOectENZzJ3748g3w7863JeZpkyvEKO94Qebm9fDQ42M+t7rdwq5Rzf8zvpv	XuM7Uh3Xaw1ILoXlVQAi4aj0++NPTLMLjKnFY=</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Is there a way to query Heliotrope what is the largest msg_id
currently in the index? I am trying to improve the imap-dumper.rb so
it does not download all my emails every time but only the new ones.
&gt;From rfc4549.txt (see section 4.3.1) I learned that the way to do this
is to FETCH all the messages from [ lastknownmsg_id + 1 : * ]. This
will give the ids of all messages added to the server after the last
sync. Reading the source code I could not find a way to query this
value.

Also while looking at the code I see that messages are stored in the
index using the msg_id as parsed by RMail. There is no further
association with the source or mailbox from where the messages were
downloaded. This I think may cause collisions if we use one Heliotrope
server with more than one email account. Not sure what is the
probability of two messages from two different IMAP servers having the
same msg_id but nothing in the standard rules out that possibility.


regards
Horacio
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00313" href="msg00313.html">Re: [sup-devel] Query for largest msg_id?</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00619.html">Re: [sup-devel] mail gem no longer needs activesupport [was:	sup-server revisited]</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00650.html">Re: [sup-devel] heliotrope: Crash with empty message.recipients</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00619.html">Re: [sup-devel] mail gem no longer needs activesupport [was:	sup-server revisited]</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00313.html">Re: [sup-devel] Query for largest msg_id?</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00502"><strong>Date</strong></a></li>
<li><a href="threads.html#00502"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

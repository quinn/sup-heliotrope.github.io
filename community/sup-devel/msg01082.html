<!-- MHonArc v2.6.18 -->
<!--X-Subject: [sup&#45;devel] new branch: maildir -->
<!--X-From-R13: Dvpu Znar <eynarNpyho.pp.pzh.rqh> -->
<!--X-Date: Thu, 25 Mar 2010 00:13:07 &#45;0700 (PDT) -->
<!--X-Message-Id: 1269499582&#45;sup&#45;2593@zyrg.net -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[sup-devel] new branch: maildir</title>
<link rev="made" href="mailto:rlane@club.cc.cmu.edu">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01009.html">Date Prev</a>][<a href="msg00944.html">Date Next</a>][<a href="msg00944.html">Thread Prev</a>][<a href="msg00987.html">Thread Next</a>][<a href="maillist.html#01082">Date Index</a>][<a href="threads.html#01082">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sup-devel] new branch: maildir</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: [sup-devel] new branch: maildir</li>
<li><em>From</em>: Rich Lane &lt;<a href="mailto:rlane%40club.cc.cmu.edu">rlane@club.cc.cmu.edu</a>&gt;</li>
<li><em>Date</em>: Thu, 25 Mar 2010 03:12:57 -0400</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: Sup/git</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>This branch makes some drastic changes to how mbox and maildir sources
work. There's no longer any state associated with a source between Sup
runs - no cur_offset or mtimes in sources.yaml. Instead, the source
queries the index to find out which messages it's already seen and which
messages are new. This enables a much more robust maildir
implementation that detects the addition or deletion of any message.

It's not totally done yet. It'll detect that a maildir message has been
deleted, but it doesn't yet remove the old location from the index so
renames are unlikely to work. There needs to be UI code to handle the
case where a message matches a search but has been deleted from all
sources, and probably a utility to remove such messages from the index. 
I expect sup-sync-back to be broken.

Keeping track of multiple locations per message requires an index format
change. The upgrade process is trivial and done automatically but you
won't be able to use that index with an older Sup. For now if you want
to try this out I suggest using a different SUP_BASE.

I'd appreciate any comments about the code or general approach. If
anyone would like to contribute an email corpus for the unwritten
testsuite or pseudocode out some testcases that would be very helpful
too.
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00987" href="msg00987.html">Re: [sup-devel] new branch: maildir</a></strong>
<ul><li><em>From:</em> Mark Alexander &lt;marka@pobox.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01009.html">Re: [sup-devel] [PATCH 2/2] Use nanosecond resolution of mtime for	generating the unique id for each message</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00944.html">Re: [sup-devel] Accept ASCII_8BIT in String.check</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00944.html">Re: [sup-devel] Accept ASCII_8BIT in String.check</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00987.html">Re: [sup-devel] new branch: maildir</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01082"><strong>Date</strong></a></li>
<li><a href="threads.html#01082"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

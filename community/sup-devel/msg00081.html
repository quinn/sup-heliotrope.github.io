<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] A maildir root source: syncing labels with maildirs	(imap folders) -->
<!--X-From-R13: Egrira Epuzrvfre <fgriraNfpuzrvfre.bet> -->
<!--X-Date: Tue, 26 Nov 2013 08:42:59 &#45;0800 (PST) -->
<!--X-Message-Id: 2AC33855&#45;6B00&#45;42FB&#45;9F3B&#45;D160D8B556D4@schmeiser.org -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1385392376&#45;sup&#45;8491@qwerzila -->
<!--X-Reference: 1385415206&#45;sup&#45;5054@qwerzila -->
<!--X-Reference: 1385476504&#45;sup&#45;9378@indy.local -->
<!--X-Reference: 1385478548&#45;sup&#45;9110@qwerzila -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] A maildir root source: syncing labels with maildirs	(imap folders)</title>
<link rev="made" href="mailto:steven@schmeiser.org">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00186.html">Date Prev</a>][<a href="msg00170.html">Date Next</a>][<a href="msg00186.html">Thread Prev</a>][<a href="msg00170.html">Thread Next</a>][<a href="maillist.html#00081">Date Index</a>][<a href="threads.html#00081">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] A maildir root source: syncing labels with maildirs	(imap folders)</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-devel] A maildir root source: syncing labels with maildirs	(imap folders)</li>
<li><em>From</em>: Steven Schmeiser &lt;<a href="mailto:steven%40schmeiser.org">steven@schmeiser.org</a>&gt;</li>
<li><em>Date</em>: Tue, 26 Nov 2013 11:42:48 -0500</li>
<li><em>Authentication-results</em>: mx.google.com;       spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 50.56.192.79 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a>;       dkim=neutral (bad format) header.i=@schmeiser.org</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=simple/simple; d=schmeiser.org;	s=default; t=1385484170;	bh=0SMvHILDVe3AzhmzdUqZYNGCV9khpeIrDMBajm46juQ=;	h=Subject:From:In-Reply-To:Date:References:To:From;	b=fhgo6UKCx3JcfaYO+vx5XDTmQxM61hmqVBCrVnfu1ppJqiUSSGS2kLbCG6sfVHHy3	wofYIrGhE22zdDBkaYlWGcqXnZhhHOYFJkfDnT3Rd+c0QYKrIwja+rFzMMlgfc1Kxj	Oa0ZpzodwZ4JssVZeLdBj7ISLSRhdpUESRSyBVE8=</li>
<li><em>In-reply-to</em>: &lt;1385478548-sup-9110@qwerzila&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;1385392376-sup-8491@qwerzila&gt; &lt;1385415206-sup-5054@qwerzila&gt;	&lt;1385476504-sup-9378@indy.local&gt; &lt;1385478548-sup-9110@qwerzila&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

On Nov 26, 2013, at 10:14, Gaute Hope &lt;eg@gaute.vetsj.com&gt; wrote:

&gt; Excerpts from Steven Schmeiser's message of 2013-11-26 15:43:49 +0100:
&gt;&gt; I've installed the branch and am trying it out.  So far it looks good, but there have been a few oddities...
&gt;&gt; 
&gt;&gt; I'm running with a standard IMAP account (not Gmail).  The root looks like
&gt;&gt; 
&gt;&gt; [steve@indy ~]$ ls -l .mail
&gt;&gt; total 0
&gt;&gt; drwx------  5 steve  staff  170 Nov 19 13:44 Archive
&gt;&gt; drwx------  5 steve  staff  170 Nov 22 12:31 INBOX
&gt;&gt; drwx------  5 steve  staff  170 Nov 19 13:44 drafts
&gt;&gt; drwx------  5 steve  staff  170 Nov 19 13:44 econpapers
&gt;&gt; drwx------  5 steve  staff  170 Nov 19 13:44 sent
&gt;&gt; drwx------  5 steve  staff  170 Nov 19 13:44 spam
&gt;&gt; drwx------  5 steve  staff  170 Nov 25 19:25 trash
&gt;&gt; 
&gt;&gt; and my sources are configured as follows
&gt;&gt; 
&gt;&gt; [steve@indy ~]$ more .sup/sources.yaml
&gt;&gt; ---
&gt;&gt; - !supmua.org,2006-10-01/Redwood/MaildirRoot
&gt;&gt;  uri: maildirroot:///Users/steve/.mail
&gt;&gt;  usual: true
&gt;&gt;  archived: false
&gt;&gt;  id: 1
&gt;&gt;  labels: []
&gt;&gt;  sync_back: true
&gt;&gt;  confirm_enable_experimental: true
&gt;&gt;  maildir_creation_allowed: true
&gt;&gt;  inbox_folder: INBOX
&gt;&gt;  sent_folder: sent
&gt;&gt;  drafts_folder: drafts
&gt;&gt;  spam_folder: spam
&gt;&gt;  trash_folder: trash
&gt;&gt;  archive_folder: Archive
&gt;&gt; - !supmua.org,2006-10-01/Redwood/SentLoader{}
&gt;&gt; 
&gt;&gt; I had around 40k messages in the Archive folder and ~20 in the INBOX. After sup-sync, around 10k of the messages in Archive were moved into sup's inbox with labels 'INBOX' and 'Inbox'.  They were also (incorrectly) marked as unread.
&gt;&gt; 
&gt;&gt; I'll keep experimenting.  Thanks for your effort -- I think this is a great new feature and would really like to see it merged into the mainline someday.
&gt; 
&gt; Ok, there are likely to be a few more of the oddities - you are brave :)
&gt; 
&gt; Please set the environment variable: SUP_LOG_LEVEL=debug and try to
&gt; start sup, it would be interesting to see how the maildirsubs are
&gt; initialized (the startup section from ~/.sup/log).
&gt; 
&gt; Were any of the messages in Archive also somewhere else (duplicates with
&gt; the same id)? Also, if sup discovers a message that is part of a thread
&gt; it will join them and (possibly) apply all the labels to all the
&gt; messages in that thread. If any of those are unread it might be
&gt; affected.
&gt; 
&gt; The labels 'INBOX' and 'Inbox' are both not the same as the special
&gt; label 'inbox', so apparently it is not recognized as the special label
&gt; but a custom label.
&gt; 
&gt; It could be that you have more luck with starting with a clean index and
&gt; just starting regular sup (not sup-sync). You can follow the log by
&gt; doing: tail -f ~/.sup/log.
&gt; 
&gt; - gaute

Startup log follows...

[2013-11-26 11:34:20 -0500] using character set encoding &quot;UTF-8&quot;
[2013-11-26 11:34:21 -0500] dynamically loading setlocale() from libc.dylib
[2013-11-26 11:34:21 -0500] setting locale...
[2013-11-26 11:34:21 -0500] locking /Users/steve/.sup/lock...
[2013-11-26 11:34:21 -0500] maildirroot:///Users/steve/.mail: setting up maildirroot..
[2013-11-26 11:34:21 -0500] setting up maildir subs..
[2013-11-26 11:34:21 -0500] maildirsub set up, type: archive, label: archive
[2013-11-26 11:34:21 -0500] maildirsub set up, type: inbox, label: inbox
[2013-11-26 11:34:21 -0500] maildirsub set up, type: sent, label: sent
[2013-11-26 11:34:21 -0500] maildirsub set up, type: draft, label: draft
[2013-11-26 11:34:21 -0500] maildirsub set up, type: spam, label: spam
[2013-11-26 11:34:21 -0500] maildirsub set up, type: deleted, label: deleted
[2013-11-26 11:34:21 -0500] setting up generic folders..
[2013-11-26 11:34:21 -0500] maildirsub set up, type: generic, label: econpapers
[2013-11-26 11:34:21 -0500] no draft source, auto-adding...
[2013-11-26 11:34:21 -0500] starting curses
[2013-11-26 11:34:21 -0500] loading user colors from /Users/steve/.sup/colors.yaml
[2013-11-26 11:34:21 -0500] initializing log buffer
[2013-11-26 11:34:21 -0500] Welcome to Sup! Log level is set to debug.
[2013-11-26 11:34:21 -0500] initializing inbox buffer
[2013-11-26 11:34:21 -0500] ready for interaction!

I'm now not able to run sup-sync or open some of the threads in my inbox without crashing with the following error:

/usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/bin/sup-sync:180:in `block (2 levels) in &lt;top (required)&gt;': NotImplementedError (NotImplementedError)
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/poll.rb:292:in `block (2 levels) in poll_from'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/index.rb:298:in `block in each_message'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/index.rb:285:in `block in each_id'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/index.rb:285:in `each'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/index.rb:285:in `each_id'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/index.rb:297:in `each_message'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/util.rb:649:in `method_missing'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/poll.rb:251:in `block in poll_from'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/maildirroot.rb:512:in `block (2 levels) in poll'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/maildirroot.rb:511:in `each'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/maildirroot.rb:511:in `block in poll'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/util.rb:261:in `call'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/util.rb:261:in `block in benchmark'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/1.9.1/benchmark.rb:280:in `measure'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/util.rb:261:in `benchmark'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/maildirroot.rb:474:in `poll'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/poll.rb:201:in `poll_from'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/lib/sup/util.rb:649:in `method_missing'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/bin/sup-sync:125:in `block in &lt;top (required)&gt;'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/bin/sup-sync:120:in `each'
        from /usr/local/Cellar/ruby193/1.9.3-p448/lib/ruby/gems/1.9.1/gems/sup-999/bin/sup-sync:120:in `&lt;top (required)&gt;'
        from /usr/local/opt/ruby193/bin/sup-sync:23:in `load'
        from /usr/local/opt/ruby193/bin/sup-sync:23:in `&lt;main&gt;'

I'll try starting with a clean index.

Steve
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00170" href="msg00170.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
<ul><li><em>From:</em> Gaute Hope &lt;eg@gaute.vetsj.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00057" href="msg00057.html">A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
<ul><li><em>From:</em> Gaute Hope &lt;eg@gaute.vetsj.com&gt;</li></ul></li>
<li><strong><a name="00140" href="msg00140.html">Re: A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
<ul><li><em>From:</em> Gaute Hope &lt;eg@gaute.vetsj.com&gt;</li></ul></li>
<li><strong><a name="00269" href="msg00269.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs	(imap folders)</a></strong>
<ul><li><em>From:</em> Steven Schmeiser &lt;steven@schmeiser.org&gt;</li></ul></li>
<li><strong><a name="00186" href="msg00186.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
<ul><li><em>From:</em> Gaute Hope &lt;eg@gaute.vetsj.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00186.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00170.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00186.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00170.html">Re: [sup-devel] A maildir root source: syncing labels with maildirs (imap folders)</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00081"><strong>Date</strong></a></li>
<li><a href="threads.html#00081"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

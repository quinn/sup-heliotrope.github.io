<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;devel] [Heliotrope/Turnsole] How to use IMAP? -->
<!--X-From-R13: [vpunry Egncryoret <zvpunry+fhcNfgncryoret.qr> -->
<!--X-Date: Mon, 27 Feb 2012 01:23:54 &#45;0800 (PST) -->
<!--X-Message-Id: 1330333805&#45;sup&#45;1287@stapelberg.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1326062741&#45;sup&#45;6469@stapelberg.de -->
<!--X-Reference: 1329113568&#45;sup&#45;8177@typhon -->
<!--X-Reference: 1329946381&#45;sup&#45;2255@stapelberg.de -->
<!--X-Reference: 1329977859&#45;turnsole&#45;79917@terminus&#45;est -->
<!--X-Reference: 1329996040&#45;sup&#45;2419@stapelberg.de -->
<!--X-Reference: 1330150790&#45;turnsole&#45;3005@terminus&#45;est -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</title>
<link rev="made" href="mailto:michael+sup@stapelberg.de">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00245.html">Date Prev</a>][<a href="msg00120.html">Date Next</a>][<a href="msg00152.html">Thread Prev</a>][<a href="msg00120.html">Thread Next</a>][<a href="maillist.html#00204">Date Index</a>][<a href="threads.html#00204">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: sup-devel &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</li>
<li><em>From</em>: Michael Stapelberg &lt;<a href="mailto:michael%2Bsup%40stapelberg.de">michael+sup@stapelberg.de</a>&gt;</li>
<li><em>Date</em>: Mon, 27 Feb 2012 10:16:43 +0100</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a> designates 50.56.192.79 as permitted sender) smtp.mail=<a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a></li>
<li><em>In-reply-to</em>: &lt;1330150790-turnsole-3005@terminus-est&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-devel">http://rubyforge.org/pipermail/sup-devel</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=help">mailto:sup-devel-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: Sup developer discussion &lt;sup-devel.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-devel@rubyforge.org">mailto:sup-devel@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=subscribe">mailto:sup-devel-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-devel">http://rubyforge.org/mailman/options/sup-devel</a>&gt;,	&lt;<a href="mailto:sup-devel-request@rubyforge.org?subject=unsubscribe">mailto:sup-devel-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00386.html">1326062741-sup-6469@stapelberg.de</a>&gt; &lt;1329113568-sup-8177@typhon&gt;	&lt;<a href="msg00112.html">1329946381-sup-2255@stapelberg.de</a>&gt;	&lt;1329977859-turnsole-79917@terminus-est&gt;	&lt;<a href="msg00205.html">1329996040-sup-2419@stapelberg.de</a>&gt;	&lt;1330150790-turnsole-3005@terminus-est&gt;</li>
<li><em>Reply-to</em>: Sup developer discussion &lt;<a href="mailto:sup-devel%40rubyforge.org">sup-devel@rubyforge.org</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-devel-bounces%40rubyforge.org">sup-devel-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: Sup/git</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi William,

Sorry for clinging to that topic, but it&#x2019;s important for me to properly
understand it.

Excerpts from William Morgan's message of 2012-02-25 07:35:32 +0100:
&gt; Excerpts from Michael Stapelberg's message of 2012-02-23 03:24:22 -0800:
&gt; &gt; Well, I guess you are correct. So, when somebody sends me a spam email
&gt; &gt; or a malicious email with a faked date, what happens? I think that the
&gt; &gt; code will figure out it needs to re-add a lot of messages. Also, my
&gt; &gt; index will need to be reordered, right?
&gt; 
&gt; You won't need to reorder. Importing is all incremental, at least if you
&gt; use --state-file: it will keep track of the last message imported, and
&gt; successive imports will only pick up new messages.
Apparently, I didn&#x2019;t properly describe the scenario I&#x2019;m thinking about:

state-file contains an entry &quot;/my/maildir/2012-02-22-foo-bar&quot;, which is an
email that contains 2012-02-22 as date.

Now, a spammer sends me an email with a faked date, let&#x2019;s say 2001-01-01, let&#x2019;s
call it &quot;/my/maildir/2001-01-01-spam-mail&quot;. The next run of heliotrope-add has
two possibilities:

1) It will completely ignore it. I think this is what will happen, based on
   your description. This is horrible! Emails are absolutely not guaranteed to
   arrive in my system in the order they were sent. Is this the case? Do we
   ignore email because of date problems like this currently?

2) It will pick up this email because the date inside is older. Subsequent runs
   will discover all email from the last 10 years as new, and try to re-add it
   to the index. Lots of unnecessary overhead.

&gt; But you are making me realize that the current maildir implementation is
&gt; not right. I think the way to handle Maildir is to look only at the
&gt; ctime of the files and not the date headers. That will make incremental
&gt; importing possible (just save the filename of the last imported file,
&gt; and look for all files newer than that). It will speed things up
&gt; anyways.
Right, that sounds good.

&gt; And if you're in the funny situation where the ctime is not correlated
&gt; with the Date: headers in your files, which is perfectly possibly by the
&gt; Maildir spec, then you will have to reorder after that initial import.
&gt; But in reality that's a possibility with the other source types
&gt; too---it's just more likely with Maildir.
So, let&#x2019;s stick to my above example of the spam email and let&#x2019;s assume that you
changed the code to use ctimes. The spam mail arrives, its ctime is new, it
gets picked up into my index. To my understanding, I now need to reorder. I
have multiple questions:

1) What are the immediate consequences? Where will this email appear in my
   inbox, when my inbox contains 5 emails. Always at the top? Bottom? You
   mentioned I can see the effect when paging. Can you elaborate please?

2) How do I know when I have to reorder?

Best regards,
Michael
_______________________________________________
Sup-devel mailing list
Sup-devel@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-devel">http://rubyforge.org/mailman/listinfo/sup-devel</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00120" href="msg00120.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00386" href="msg00386.html">[sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> Michael Stapelberg &lt;michael+sup@stapelberg.de&gt;</li></ul></li>
<li><strong><a name="00234" href="msg00234.html">[sup-devel]  [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
<li><strong><a name="00112" href="msg00112.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> Michael Stapelberg &lt;michael+sup@stapelberg.de&gt;</li></ul></li>
<li><strong><a name="00335" href="msg00335.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
<li><strong><a name="00205" href="msg00205.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> Michael Stapelberg &lt;michael+sup@stapelberg.de&gt;</li></ul></li>
<li><strong><a name="00152" href="msg00152.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan-sup@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00245.html">[sup-devel]  [Heliotrope] Equivalent of archived sources</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00120.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00152.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00120.html">Re: [sup-devel] [Heliotrope/Turnsole] How to use IMAP?</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00204"><strong>Date</strong></a></li>
<li><a href="threads.html#00204"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

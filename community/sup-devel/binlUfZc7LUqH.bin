From 230e8befb34bac38055599728923bc2999bc5e94 Mon Sep 17 00:00:00 2001
From: Tero Tilus <tero@tilus.net>
Date: Sun, 21 Feb 2010 09:35:59 +0200
Subject: [PATCH] Make automatic jumping to first/next open message configurable

---
 lib/sup.rb                         |    1 +
 lib/sup/modes/thread-index-mode.rb |    2 +-
 lib/sup/modes/thread-view-mode.rb  |    2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/lib/sup.rb b/lib/sup.rb
index b9dc749..5114715 100644
--- a/lib/sup.rb
+++ b/lib/sup.rb
@@ -260,6 +260,7 @@ else
     :ask_for_subject => true,
     :confirm_no_attachments => true,
     :confirm_top_posting => true,
+    :jump_to_open_message => true,
     :discard_snippets_from_encrypted_messages => false,
     :default_attachment_save_dir => "",
     :sent_source => "sup://sent",
diff --git a/lib/sup/modes/thread-index-mode.rb b/lib/sup/modes/thread-index-mode.rb
index a6bb2b9..7be5a1b 100644
--- a/lib/sup/modes/thread-index-mode.rb
+++ b/lib/sup/modes/thread-index-mode.rb
@@ -111,7 +111,7 @@ EOS
       mode = ThreadViewMode.new t, @hidden_labels, self
       BufferManager.spawn t.subj, mode
       BufferManager.draw_screen
-      mode.jump_to_first_open
+      mode.jump_to_first_open if $config[:jump_to_open_message]
       BufferManager.draw_screen # lame TODO: make this unnecessary
       ## the first draw_screen is needed before topline and botline
       ## are set, and the second to show the cursor having moved
diff --git a/lib/sup/modes/thread-view-mode.rb b/lib/sup/modes/thread-view-mode.rb
index 0e935a4..001a55b 100644
--- a/lib/sup/modes/thread-view-mode.rb
+++ b/lib/sup/modes/thread-view-mode.rb
@@ -330,7 +330,7 @@ EOS
     elsif chunk.viewable?
       view chunk
     end
-    if chunk.is_a?(Message)
+    if chunk.is_a?(Message) && $config[:jump_to_open_message]
       jump_to_message chunk
       jump_to_next_open if layout.state == :closed
     end
-- 
1.5.6.5


<!-- MHonArc v2.6.18 -->
<!--X-Subject: [sup&#45;talk] PGP INLINE &#45; can't make it work -->
<!--X-From-R13: xbfzvpv&#45;ngnxhwnNjc.cy -->
<!--X-Date: Fri, 26 Feb 2010 09:15:53 &#45;0800 (PST) -->
<!--X-Message-Id: 201002261808.36354.kosmici&#45;atakuja@wp.pl -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[sup-talk] PGP INLINE - can't make it work</title>
<link rev="made" href="mailto:kosmici-atakuja@wp.pl">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01215.html">Date Prev</a>][<a href="msg01251.html">Date Next</a>][<a href="msg01298.html">Thread Prev</a>][<a href="msg01251.html">Thread Next</a>][<a href="maillist.html#01177">Date Index</a>][<a href="threads.html#01177">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sup-talk] PGP INLINE - can't make it work</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:sup-talk%40rubyforge.org">sup-talk@rubyforge.org</a></li>
<li><em>Subject</em>: [sup-talk] PGP INLINE - can't make it work</li>
<li><em>From</em>: <a href="mailto:kosmici-atakuja%40wp.pl">kosmici-atakuja@wp.pl</a></li>
<li><em>Date</em>: Fri, 26 Feb 2010 18:08:36 +0100</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a> designates 205.234.109.19 as permitted sender) smtp.mail=<a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-talk%40rubyforge.org">sup-talk@rubyforge.org</a></li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-talk">http://rubyforge.org/pipermail/sup-talk</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=help">mailto:sup-talk-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: User &amp; developer discussion of Sup &lt;sup-talk.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-talk@rubyforge.org">mailto:sup-talk@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-talk">http://rubyforge.org/mailman/listinfo/sup-talk</a>&gt;,	&lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=subscribe">mailto:sup-talk-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-talk">http://rubyforge.org/mailman/options/sup-talk</a>&gt;,	&lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=unsubscribe">mailto:sup-talk-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a></li>
<li><em>User-agent</em>: KMail/1.13.0 (Linux/2.6.32-ck; KDE/4.4.0; x86_64; ; )</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>First of wall I want to say I absolutely love sup! I used all the major mail 
clients like mutt, claws, thunderbird, kmail. All mail clients just fail (mutt 
was the closest though...). Sup so far has the potential to be the best of 
them. If only I can get it to read the inline gpg that enigmail makes...

Example email looks like this in sup: 

 -----BEGIN PGP MESSAGE-----
  Charset: UTF-8
  Version: GnuPG v1.4.9 (MingW32)
  Comment: Using GnuPG with Mozilla - <a  rel="nofollow" href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a>

  hQIOA3WKxDKSmLd7EAf/cKH72GNHWgkY46sjHuYBlV5Q9udlmjB1ucTqtVfSUysH
[cut]
 NYqMmmJ1HHG58B9bPqGFPNe/jEPeiiqj9Ez58kYzS32VeelJFwV+O8K9/TAvG4HN
  fEIgtYMGj0Uc5v0eZ7yVqFfluJrEX5V7mN2InahTCD+uFEfguvld8rZagEtlyxU5
  =nAMm
  -----END PGP MESSAGE-----

And it gets displayed like this, no error messages or anything. I have 
configured my gpg in sup as per this wiki page:
<a  rel="nofollow" href="http://sup.rubyforge.org/wiki/wiki.pl?GPG">http://sup.rubyforge.org/wiki/wiki.pl?GPG</a>
(with the numeric ID and such). 

And I enabled verbose debug logging, here's the log:
(cutting leading timestamp for better reading)

using character set encoding &quot;UTF-8&quot;
No 'chronic' gem detected. Install it for date/time query restrictions.
No 'ncursesw' gem detected. Install it for wide character support.
dynamically loading setlocale() from libc.so.6
setting locale...
using xapian index
locking /home/piotr/.sup/lock...
crypto: detected gpg binary in /usr/bin/gpg
starting curses
initializing log buffer
Welcome to Sup! Log level is set to debug.
initializing inbox buffer
ready for interaction!
colormap: for color twiddle_color, using id 1 -&gt; 4, -1
colormap: for color status_color, using id 2 -&gt; 7, 4
colormap: for color tagged_color_highlight, using id 3 -&gt; 3, 6
colormap: for color date_color_highlight, using id 4 -&gt; 0, 6
colormap: for color to_me_color_highlight, using id 5 -&gt; 2, 6
colormap: for color tagged_color, using id 6 -&gt; 3, -1
colormap: for color date_color, using id 7 -&gt; 7, -1
colormap: for color to_me_color, using id 8 -&gt; 2, -1
colormap: for color snippet_color, using id 9 -&gt; 6, -1
scanning maildir /home/piotr/Mail...
done scanning maildir
crypto: running: /usr/bin/gpg --quiet --batch --no-verbose --logger-fd 1 --
use-agent --output /tmp/32042-0-redwood.outp
scanning maildir /home/piotr/Mail...
done scanning maildir
crypto: running: /usr/bin/gpg --quiet --batch --no-verbose --logger-fd 1 --
use-agent --output /tmp/32042-0-redwood.outp
crypto: running: /usr/bin/gpg --quiet --batch --no-verbose --logger-fd 1 --
use-agent --output /tmp/32042-2-redwood.outp
crypto: running: /usr/bin/gpg --quiet --batch --no-verbose --logger-fd 1 --
use-agent --output /tmp/32042-0-redwood.outp
colormap: for color alternate_patina_color, using id 10 -&gt; 0, 4
colormap: for color message_patina_color, using id 11 -&gt; 0, 2
colormap: for color system_buf_color_highlight, using id 12 -&gt; 7, 6

(no errors there as far as I can see... And looks like it's running the gpg 
binary succesfully... I just changed the maildir path for privacy in this log)

GPG is configured to use gpg-agent, the gpg-agent is running, pinentry program 
shows up when running sup and I enter the correct password. I checked the 
password many times already. Also, the environment variable $GPG_AGENT_INFO is 
present and visible in sup environment (it's global and visible anywhere). 
I already tried it without &quot;use gpg-agent&quot; and the effect was the same. 

In mutt this worked, I mean the inline gpg messages were decrypted using this 
same setup of gpg-agent and gpg. It also works in kmail (although not 
perfectly, but decodes the messages).

Now, this may be a clue: when normal gpg message is used (mime) it sometimes 
geta decrypted and sometimes doesn't. If it doesn't, sup only says this in the 
message: 
    x This message has been decrypted for display
    x Attachment: sup-attachment-1267203299-4513. (multipart/mixed; 71b)

When I'm trying to display this attachment it says: 
For some bizarre reason, RubyMail was unable to parse this attachment.
and in the status line:
Couldn't execute view command, viewing as text.

(this may be because I have no run-mailcap file, but the message was in plain 
text, no html, so it shouldn't be needed now should it? I'm planning on 
getting some run-mailcap script from some debian system when I have some time, 
but for now this inline GPG is my main priority)

I'm still not sure why they sometimes decrypt correctly and sometimes not, but 
I can work with this, at least it works sometimes. But even when mime gpg 
works, the inline stuff doesn't. 

Verisions:
I'm using sup version 0.10.2 from Archlinux AUR. 
ruby version is 1.9.1
xapian-core is 1.0.18

Is there anything I can do to get this working? This is a crucial feature for 
me as almost all my work colleagues use thunderbird and enigmail to send their 
email and that uses inline pgp crap as default (which I know is not conforming 
to any standards etc.). And even if I can convince verybody to switch to mime, 
I still have a couple hundred megs of archives in this damn format. 

Moreover, I searched the list archives and it looks like some people have got 
it working as there have been patches to make it work a couple of months ago. 
And my version is recent (January) so those patches should be in it. It just 
doesn't for me for some reason :(

I know I should read crypto.rb and figure it out from there. I tried, I just 
can't understand it, as I'm not experienced in ruby, or email clients code for 
that matter. 

Please help!
Thank you
Piotr
_______________________________________________
sup-talk mailing list
sup-talk@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-talk">http://rubyforge.org/mailman/listinfo/sup-talk</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="01251" href="msg01251.html">Re: [sup-talk] PGP INLINE - can't make it work</a></strong>
<ul><li><em>From:</em> Sven Schober &lt;sven.schober@uni-ulm.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01215.html">Re: [sup-talk] curses exception</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg01251.html">Re: [sup-talk] PGP INLINE - can't make it work</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg01298.html">Re: [sup-talk] Switching to Exchange</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01251.html">Re: [sup-talk] PGP INLINE - can't make it work</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01177"><strong>Date</strong></a></li>
<li><a href="threads.html#01177"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>

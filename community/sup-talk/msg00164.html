<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: [sup&#45;talk] [sup&#45;devel] [heliotrope] crashes while importing -->
<!--X-From-R13: =?GFT&#45;8?C?Xbunaa_Yy=Q3=O4ua?= <xywbunaaNtznvy.pbz> -->
<!--X-Date: Sat, 21 Apr 2012 10:39:44 &#45;0700 (PDT) -->
<!--X-Message-Id: CAE+8KM0SqqLfGKnTTAw6TDRdb0eTBftJdueBghGxnoXE+wN3hg@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20120301151701.23555.84803@localhost -->
<!--X-Reference: 1330985181&#45;sup&#45;8598@typhon -->
<!--X-Reference: CAE+8KM0gu1UD=gGXfiEwmceW82AxF02Y+=Y&#45;AZTW3SR5hToXZg@mail.gmail.com -->
<!--X-Reference: CAE+8KM3BeubqLWAZFYOYjEiVUYpQT3vhwhaf37r1BzVECngbJA@mail.gmail.com -->
<!--X-Reference: 1334932275&#45;turnsole&#45;49140@terminus&#45;est -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: [sup-talk] [sup-devel] [heliotrope] crashes while importing</title>
<link rev="made" href="mailto:kljohann@gmail.com">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00261.html">Date Prev</a>][<a href="msg00328.html">Date Next</a>][<a href="msg00261.html">Thread Prev</a>][<a href="msg00292.html">Thread Next</a>][<a href="maillist.html#00164">Date Index</a>][<a href="threads.html#00164">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sup-talk] [sup-devel] [heliotrope] crashes while importing</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: William Morgan &lt;<a href="mailto:wmorgan%40masanjin.net">wmorgan@masanjin.net</a>&gt;</li>
<li><em>Subject</em>: Re: [sup-talk] [sup-devel] [heliotrope] crashes while importing</li>
<li><em>From</em>: Johann Kl&#xE4;hn &lt;<a href="mailto:kljohann%40gmail.com">kljohann@gmail.com</a>&gt;</li>
<li><em>Date</em>: Sat, 21 Apr 2012 19:36:27 +0200</li>
<li><em>Authentication-results</em>: mx.google.com; spf=pass (google.com: domain of <a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a> designates 50.56.192.79 as permitted sender) smtp.mail=<a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a>; dkim=neutral (body hash did not verify) header.i=@gmail.com</li>
<li><em>Cc</em>: sup-talk &lt;<a href="mailto:sup-talk%40rubyforge.org">sup-talk@rubyforge.org</a>&gt;</li>
<li><em>Delivered-to</em>: <a href="mailto:eg%40gaute.vetsj.com">eg@gaute.vetsj.com</a></li>
<li><em>Delivered-to</em>: <a href="mailto:sup-talk%40rubyforge.org">sup-talk@rubyforge.org</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;	h=mime-version:in-reply-to:references:from:date:message-id:subject:to	:cc:content-type;	bh=6r+LdEC3UgHFgkP9ThD7GiwGfWsIehKX4s3is6HXkHc=;	b=R36udXiCQuwD3Yw5lGoujP8QoMn39MwyRT1wfBDofh1VQJ+DmudJIH52Glw9dz3+w4	TuhtA75SWPnFT6kC+yAsvQbxYDd949GtHgUO+4qNXxdeJ+uHjdgp+IkxENnoUEtb/1al	kT5wElA6hXfbfUvpqHUWneNDkfiHuwXrVMlk3Ym6tZldr5+xR6M18lHAdJiSq4fcDJhQ	7CDV33oNdmQvSLxtQMg/6fv80p5r2FD349urelUDjQwCoQRI+NprEqdYhZjK3jOwa8te	ngtSwk20lAP0LZtEBddsFH7oAxEt6hSDkVyScA2QJNx3sSoWazcxWaMY6v4zI8HwzpX/	p/Ow==</li>
<li><em>In-reply-to</em>: &lt;1334932275-turnsole-49140@terminus-est&gt;</li>
<li><em>List-archive</em>: &lt;<a href="http://rubyforge.org/pipermail/sup-talk">http://rubyforge.org/pipermail/sup-talk</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=help">mailto:sup-talk-request@rubyforge.org?subject=help</a>&gt;</li>
<li><em>List-id</em>: User &amp; developer discussion of Sup &lt;sup-talk.rubyforge.org&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:sup-talk@rubyforge.org">mailto:sup-talk@rubyforge.org</a>&gt;</li>
<li><em>List-subscribe</em>: &lt;<a href="http://rubyforge.org/mailman/listinfo/sup-talk">http://rubyforge.org/mailman/listinfo/sup-talk</a>&gt;,	&lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=subscribe">mailto:sup-talk-request@rubyforge.org?subject=subscribe</a>&gt;</li>
<li><em>List-unsubscribe</em>: &lt;<a href="http://rubyforge.org/mailman/options/sup-talk">http://rubyforge.org/mailman/options/sup-talk</a>&gt;,	&lt;<a href="mailto:sup-talk-request@rubyforge.org?subject=unsubscribe">mailto:sup-talk-request@rubyforge.org?subject=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;20120301151701.23555.84803@localhost&gt; &lt;1330985181-sup-8598@typhon&gt;	&lt;CAE+8KM0gu1UD=gGXfiEwmceW82AxF02Y+=Y-AZTW3SR5hToXZg@mail.gmail.com&gt;	&lt;CAE+8KM3BeubqLWAZFYOYjEiVUYpQT3vhwhaf37r1BzVECngbJA@mail.gmail.com&gt;	&lt;1334932275-turnsole-49140@terminus-est&gt;</li>
<li><em>Sender</em>: <a href="mailto:sup-talk-bounces%40rubyforge.org">sup-talk-bounces@rubyforge.org</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi William,

after running gdb I found the following on the debian bug tracker
(<a  rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=627818">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=627818</a> on a bug
related to ffmpeg):

eglibc (2.13-3) unstable; urgency=low
  Starting with version 2.13, eglibc provides an SSSE3 optimized version
  of memcpy() on the amd64 architecture. This version might copy memory
  backward in some conditions, which causes issues if the source and
  destination overlap. memmove() should be used in such cases, but some
  programs still wrongly use memcpy().

The cause of the segmentation fault seems to be the call to memcpy()
in PosixMmapFile::Append(leveldb::Slice const&amp;) in
leveldb/util/env_posix.cc.
Please note that I am indeed on amd64 (and using glibc 2.15).

Best wishes,
Johann

Stack trace follows:

#0  0x00007ffff7755ce1 in __memcpy_ssse3_back () from /lib/libc.so.6
#1  0x00007ffff378e9dd in leveldb::(anonymous
namespace)::PosixMmapFile::Append(leveldb::Slice const&amp;) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#2  0x00007ffff377b091 in
leveldb::log::Writer::EmitPhysicalRecord(leveldb::log::RecordType,
char const*, unsigned long) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#3  0x00007ffff377b1e4 in
leveldb::log::Writer::AddRecord(leveldb::Slice const&amp;) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#4  0x00007ffff3770b71 in leveldb::DBImpl::Write(leveldb::WriteOptions
const&amp;, leveldb::WriteBatch*) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#5  0x00007ffff3770f25 in leveldb::DB::Put(leveldb::WriteOptions
const&amp;, leveldb::Slice const&amp;, leveldb::Slice const&amp;) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#6  0x00007ffff3770f79 in leveldb::DBImpl::Put(leveldb::WriteOptions
const&amp;, leveldb::Slice const&amp;, leveldb::Slice const&amp;) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#7  0x00007ffff376e323 in db_put(int, unsigned long*, unsigned long) ()
   from /home/joni/.gem/ruby/1.9.1/gems/leveldb-ruby-0.14/lib/leveldb/leveldb.so
#8  0x00007ffff7b177c3 in ?? () from /usr/lib/libruby.so.1.9
_______________________________________________
sup-talk mailing list
sup-talk@rubyforge.org
<a  rel="nofollow" href="http://rubyforge.org/mailman/listinfo/sup-talk">http://rubyforge.org/mailman/listinfo/sup-talk</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00292" href="msg00292.html">Re: [sup-talk] [sup-devel] [heliotrope] crashes while importing</a></strong>
<ul><li><em>From:</em> Johann Kl&#xE4;hn &lt;kljohann@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00261" href="msg00261.html">[sup-talk] Fwd: [sup-devel] [heliotrope] crashes while importing</a></strong>
<ul><li><em>From:</em> William Morgan &lt;wmorgan@masanjin.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00261.html">[sup-talk] Fwd: [sup-devel] [heliotrope] crashes while importing</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00328.html">[sup-talk] Fwd: Hook to labelize sended emails?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00261.html">[sup-talk] Fwd: [sup-devel] [heliotrope] crashes while importing</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00292.html">Re: [sup-talk] [sup-devel] [heliotrope] crashes while importing</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00164"><strong>Date</strong></a></li>
<li><a href="threads.html#00164"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
